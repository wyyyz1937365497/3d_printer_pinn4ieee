# 3D Printer PINN-Seq3D Framework

## é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªåŸºäºç‰©ç†ä¿¡æ¯ç¥ç»ç½‘ç»œï¼ˆPINNï¼‰å’Œåºåˆ—æ¨¡å‹çš„3Dæ‰“å°è´¨é‡é¢„æµ‹ä¸è½¨è¿¹ä¼˜åŒ–ç³»ç»Ÿã€‚é¡¹ç›®ç»“åˆäº†ç‰©ç†çº¦æŸå’Œæ·±åº¦å­¦ä¹ ï¼Œå®ç°ä¸¤å¤§æ ¸å¿ƒåŠŸèƒ½ï¼š

1. **è´¨é‡é¢„æµ‹ä¸æ—©åœç³»ç»Ÿ**ï¼šé€šè¿‡ä¼ æ„Ÿå™¨æ•°æ®å®æ—¶é¢„æµ‹æ‰“å°è´¨é‡ï¼Œå®ç°æ—©æœŸæ•…éšœæ£€æµ‹
2. **è½¨è¿¹ä¼˜åŒ–ä¸è¯¯å·®è¡¥å¿**ï¼šé’ˆå¯¹å¿«é€Ÿè½¬è§’ç­‰å…³é”®ä½ç½®è¿›è¡Œè¯¯å·®é¢„æµ‹ä¸è¡¥å¿

## æ ¸å¿ƒåˆ›æ–°

- ğŸ¯ **ç‰©ç†ä¿¡æ¯å¼•å¯¼**ï¼šå°†çƒ­åŠ›å­¦ã€æŒ¯åŠ¨åŠ¨åŠ›å­¦ç­‰ç‰©ç†å®šå¾‹åµŒå…¥æŸå¤±å‡½æ•°
- ğŸ”„ **æ··åˆåºåˆ—å»ºæ¨¡**ï¼šTransformer + BiLSTM æ•æ‰å¤šå°ºåº¦æ—¶åºä¾èµ–
- ğŸ­ **å¤šä»»åŠ¡å­¦ä¹ **ï¼šç»Ÿä¸€æ¡†æ¶åŒæ—¶å¤„ç†è´¨é‡é¢„æµ‹å’Œè½¨è¿¹ä¼˜åŒ–
- ğŸ“¦ **æ¨¡å—åŒ–è®¾è®¡**ï¼šæ¸…æ™°çš„ä»£ç ç»“æ„ï¼Œæ˜“äºæ‰©å±•å’Œç»´æŠ¤

## é¡¹ç›®ç»“æ„

```
3d_printer_pinn4ieee/
â”œâ”€â”€ README.md                    # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ PROJECT_STRUCTURE.md         # æœ¬æ–‡ä»¶
â”œâ”€â”€ requirements.txt             # ä¾èµ–åŒ…
â”œâ”€â”€ config/                      # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ base_config.py          # åŸºç¡€é…ç½®
â”‚   â””â”€â”€ model_config.py         # æ¨¡å‹é…ç½®
â”‚
â”œâ”€â”€ data/                        # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ raw/                    # åŸå§‹æ•°æ®
â”‚   â”œâ”€â”€ processed/              # é¢„å¤„ç†åçš„æ•°æ®
â”‚   â””â”€â”€ simulation/             # ä»¿çœŸæ•°æ®
â”‚
â”œâ”€â”€ models/                      # æ¨¡å‹å®šä¹‰
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ base_model.py           # åŸºç¡€æ¨¡å‹ç±»
â”‚   â”œâ”€â”€ encoders/               # ç¼–ç å™¨æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ pinn_encoder.py    # PINNå¼•å¯¼çš„ç¼–ç å™¨
â”‚   â”‚   â””â”€â”€ transformer_encoder.py
â”‚   â”œâ”€â”€ decoders/               # è§£ç å™¨æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ quality_decoder.py # è´¨é‡é¢„æµ‹è§£ç å™¨
â”‚   â”‚   â””â”€â”€ trajectory_decoder.py # è½¨è¿¹æ ¡æ­£è§£ç å™¨
â”‚   â”œâ”€â”€ physics/                # ç‰©ç†çº¦æŸæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ thermal_physics.py # çƒ­åŠ›å­¦çº¦æŸ
â”‚   â”‚   â”œâ”€â”€ vibration_physics.py # æŒ¯åŠ¨åŠ¨åŠ›å­¦çº¦æŸ
â”‚   â”‚   â””â”€â”€ energy_physics.py  # èƒ½é‡å®ˆæ’çº¦æŸ
â”‚   â””â”€â”€ unified_model.py        # ç»Ÿä¸€æ¨¡å‹
â”‚
â”œâ”€â”€ training/                    # è®­ç»ƒç›¸å…³
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ trainer.py             # ç»Ÿä¸€è®­ç»ƒå™¨
â”‚   â”œâ”€â”€ losses.py              # æŸå¤±å‡½æ•°
â”‚   â”œâ”€â”€ optimizers.py          # ä¼˜åŒ–å™¨é…ç½®
â”‚   â””â”€â”€ schedulers.py          # å­¦ä¹ ç‡è°ƒåº¦å™¨
â”‚
â”œâ”€â”€ evaluation/                  # è¯„ä¼°æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ metrics.py             # è¯„ä¼°æŒ‡æ ‡
â”‚   â””â”€â”€ visualizer.py          # å¯è§†åŒ–å·¥å…·
â”‚
â”œâ”€â”€ inference/                   # æ¨ç†æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ predictor.py           # æ¨ç†å¼•æ“
â”‚
â”œâ”€â”€ utils/                       # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ data_utils.py          # æ•°æ®å¤„ç†å·¥å…·
â”‚   â”œâ”€â”€ physics_utils.py       # ç‰©ç†è®¡ç®—å·¥å…·
â”‚   â””â”€â”€ logger.py              # æ—¥å¿—å·¥å…·
â”‚
â”œâ”€â”€ experiments/                 # å®éªŒè„šæœ¬
â”‚   â”œâ”€â”€ train_quality_model.py # è®­ç»ƒè´¨é‡é¢„æµ‹æ¨¡å‹
â”‚   â”œâ”€â”€ train_trajectory_model.py # è®­ç»ƒè½¨è¿¹æ ¡æ­£æ¨¡å‹
â”‚   â””â”€â”€ train_unified_model.py # è®­ç»ƒç»Ÿä¸€æ¨¡å‹
â”‚
â”œâ”€â”€ matlab_simulation/          # MATLABç‰©ç†ä»¿çœŸ
â”‚   â”œâ”€â”€ physics_parameters.m    # ç‰©ç†å‚æ•°é…ç½®
â”‚   â”œâ”€â”€ parse_gcode.m           # G-codeè§£æå™¨
â”‚   â”œâ”€â”€ simulate_trajectory_error.m # è½¨è¿¹è¯¯å·®ä»¿çœŸ
â”‚   â”œâ”€â”€ simulate_thermal_field.m # æ¸©åº¦åœºä»¿çœŸ
â”‚   â”œâ”€â”€ run_full_simulation.m   # ä¸»ä»¿çœŸè„šæœ¬
â”‚   â”œâ”€â”€ convert_matlab_to_python.py # MATLABâ†’Pythonè½¬æ¢å™¨
â”‚   â”œâ”€â”€ README.md               # æ–‡æ¡£
â”‚   â””â”€â”€ IMPROVED_PARSER_GUIDE.md # æ”¹è¿›è§£æå™¨æŒ‡å—
â”‚
â””â”€â”€ checkpoints/                 # æ¨¡å‹æ£€æŸ¥ç‚¹
    â”œâ”€â”€ quality_predictor/
    â”œâ”€â”€ trajectory_corrector/
    â””â”€â”€ unified_model/
```

## æ¨¡å‹æ¶æ„

### ç»Ÿä¸€æ¨¡å‹æ¶æ„ï¼ˆUnified PINN-Seq3Dï¼‰

```
è¾“å…¥ï¼šæ—¶åºä¼ æ„Ÿå™¨æ•°æ® [batch, seq_len, features]
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           å…±äº«ç¼–ç å™¨ (Shared Encoder)          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  PINN-Guided Transformer Encoder        â”‚  â”‚
â”‚  â”‚  - Positional Encoding                  â”‚  â”‚
â”‚  â”‚  - Multi-Head Self-Attention (8 heads)  â”‚  â”‚
â”‚  â”‚  - Physics-Informed Feed-Forward        â”‚  â”‚
â”‚  â”‚  - Layer Normalization + Residual       â”‚  â”‚
â”‚  â”‚  - 6 Layers, d_model=256                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â†“                 â†“                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è´¨é‡é¢„æµ‹åˆ†æ”¯  â”‚ â”‚ æ•…éšœåˆ†ç±»åˆ†æ”¯  â”‚ â”‚ è½¨è¿¹æ ¡æ­£åˆ†æ”¯  â”‚
â”‚ Quality      â”‚ â”‚ Fault        â”‚ â”‚ Trajectory   â”‚
â”‚ Decoder      â”‚ â”‚ Classifier   â”‚ â”‚ Decoder      â”‚
â”‚              â”‚ â”‚              â”‚ â”‚              â”‚
â”‚ - MLP Head   â”‚ â”‚ - Linear+Softâ”‚ â”‚ - BiLSTM     â”‚
â”‚ - Regression â”‚ â”‚ - 4 Classes  â”‚ â”‚ - Attention  â”‚
â”‚              â”‚ â”‚              â”‚ â”‚ - Regression â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“                 â†“                 â†“
 è´¨é‡æŒ‡æ ‡é¢„æµ‹      æ•…éšœç±»å‹åˆ†ç±»      è¯¯å·®è¡¥å¿å‘é‡
(RUL, æ¸©åº¦ç­‰)     (4ç±»æ•…éšœ)        (dx, dy)
```

## ç‰©ç†çº¦æŸ

### 1. çƒ­åŠ›å­¦çº¦æŸ
```
âˆ‚T/âˆ‚t = Î±âˆ‡Â²T + Q(x,t)
- T: æ¸©åº¦åœº
- Î±: çƒ­æ‰©æ•£ç³»æ•°
- Q: çƒ­æºé¡¹
```

### 2. æŒ¯åŠ¨åŠ¨åŠ›å­¦çº¦æŸ
```
mÂ·dÂ²x/dtÂ² + cÂ·dx/dt + kÂ·x = F(t)
- m: è´¨é‡
- c: é˜»å°¼ç³»æ•°
- k: åˆšåº¦
- F: å¤–åŠ›
```

### 3. èƒ½é‡å®ˆæ’çº¦æŸ
```
dE/dt = P_in - P_out - P_loss
- E: ç³»ç»Ÿæ€»èƒ½é‡
- P_in: è¾“å…¥åŠŸç‡
- P_out: è¾“å‡ºåŠŸç‡
- P_loss: æŸè€—åŠŸç‡
```

### 4. ç”µæœºè€¦åˆçº¦æŸ
```
I_motor âˆ acceleration + vibration_load
- I_motor: ç”µæœºç”µæµ
- acceleration: åŠ é€Ÿåº¦
- vibration_load: æŒ¯åŠ¨è´Ÿè½½
```

## æ•°æ®æ ¼å¼

### è¾“å…¥ç‰¹å¾ï¼ˆä¼ æ„Ÿå™¨æ•°æ®ï¼‰
```
- æ¸©åº¦ï¼šå–·å˜´æ¸©åº¦ã€åºŠæ¸©ã€ç¯å¢ƒæ¸©åº¦
- æŒ¯åŠ¨ï¼šX/Y/Zè½´æŒ¯åŠ¨åŠ é€Ÿåº¦
- ç”µæµï¼šX/Y/Zè½´ç”µæœºç”µæµ
- å‹åŠ›ï¼šæŒ¤å‡ºæœºå‹åŠ›
- ä½ç½®ï¼šX/Y/Zåæ ‡
- é€Ÿåº¦ï¼šX/Y/Zæ–¹å‘é€Ÿåº¦
- æ—¶é—´æˆ³
```

### è¾“å‡ºï¼ˆè´¨é‡é¢„æµ‹ï¼‰
```
- RULï¼ˆå‰©ä½™ä½¿ç”¨å¯¿å‘½ï¼‰
- æ¸©åº¦åœºé‡å»º
- æŒ¯åŠ¨åœºé‡å»º
- æ•…éšœæ¦‚ç‡ï¼ˆ4ç±»ï¼‰
- è´¨é‡è¯„åˆ†
```

### è¾“å‡ºï¼ˆè½¨è¿¹æ ¡æ­£ï¼‰
```
- Xæ–¹å‘ä½ç§»è¡¥å¿
- Yæ–¹å‘ä½ç§»è¡¥å¿
- Zæ–¹å‘ä½ç§»è¡¥å¿
- é€Ÿåº¦è°ƒæ•´å»ºè®®
```

## è®­ç»ƒç­–ç•¥

### å¤šä»»åŠ¡æŸå¤±å‡½æ•°
```python
total_loss = Î»_quality * L_quality +
             Î»_fault * L_fault +
             Î»_trajectory * L_trajectory +
             Î»_physics * L_physics

å…¶ä¸­ï¼š
- L_quality: è´¨é‡é¢„æµ‹æŸå¤±ï¼ˆMSEï¼‰
- L_fault: æ•…éšœåˆ†ç±»æŸå¤±ï¼ˆCrossEntropyï¼‰
- L_trajectory: è½¨è¿¹æ ¡æ­£æŸå¤±ï¼ˆMSEï¼‰
- L_physics: ç‰©ç†çº¦æŸæŸå¤±ï¼ˆPDEæ®‹å·®ï¼‰
```

### ä¼˜åŒ–å™¨é…ç½®
- ä¼˜åŒ–å™¨ï¼šAdamW
- åˆå§‹å­¦ä¹ ç‡ï¼š1e-4
- æƒé‡è¡°å‡ï¼š1e-5
- æ¢¯åº¦è£å‰ªï¼šmax_norm=1.0
- å­¦ä¹ ç‡è°ƒåº¦ï¼šCosine Annealing + Warmup

### è®­ç»ƒæŠ€å·§
- æ··åˆç²¾åº¦è®­ç»ƒï¼ˆAMPï¼‰
- æ¢¯åº¦ç´¯ç§¯ï¼ˆaccumulation_steps=2ï¼‰
- Early Stopping
- æ¨¡å‹æ£€æŸ¥ç‚¹ä¿å­˜

## ä½¿ç”¨æ–¹æ³•

### 1. ç¯å¢ƒé…ç½®
```bash
pip install -r requirements.txt
```

### 2. æ•°æ®å‡†å¤‡ï¼ˆä½¿ç”¨MATLABä»¿çœŸï¼‰
```bash
# åœ¨MATLABä¸­è¿è¡Œå®Œæ•´ä»¿çœŸ
% run_full_simulation.m

# è½¬æ¢ä¸ºPythonè®­ç»ƒæ•°æ®
python matlab_simulation/convert_matlab_to_python.py <simulation_file>.mat training -o training_data.h5
```

### 3. è®­ç»ƒæ¨¡å‹
```bash
# è®­ç»ƒç»Ÿä¸€æ¨¡å‹
python experiments/train_unified_model.py

# æˆ–åˆ†åˆ«è®­ç»ƒ
python experiments/train_quality_model.py
python experiments/train_trajectory_model.py
```

### 4. æ¨ç†é¢„æµ‹
```python
from inference.predictor import UnifiedPredictor

predictor = UnifiedPredictor.load_from_checkpoint('checkpoints/unified_model/best_model.pth')
results = predictor.predict(sensor_data)

quality_metrics = results['quality']
fault_prediction = results['fault']
trajectory_correction = results['trajectory']
```

## æ€§èƒ½æŒ‡æ ‡

### è´¨é‡é¢„æµ‹æ¨¡å—
- æ¸©åº¦é¢„æµ‹ RMSE: < 0.5Â°C
- æŒ¯åŠ¨é¢„æµ‹ RMSE: < 0.02mm
- RULé¢„æµ‹ RMSE: < 50s
- æ•…éšœåˆ†ç±»å‡†ç¡®ç‡: > 95%

### è½¨è¿¹æ ¡æ­£æ¨¡å—
- è½¬è§’è¯¯å·®å‡å°‘: > 90%
- å¹³å‡é¢„æµ‹è¯¯å·®: < 5mm
- å®æ—¶æ¨ç†é€Ÿåº¦: > 100Hz

## æŠ€æœ¯æ ˆ

- **æ·±åº¦å­¦ä¹ æ¡†æ¶**: PyTorch 2.0+
- **æ•°å€¼è®¡ç®—**: NumPy, SciPy
- **æ•°æ®å¤„ç†**: Pandas
- **å¯è§†åŒ–**: Matplotlib, Seaborn
- **æ—¥å¿—**: TensorBoard, Weights & Biases

## å¼•ç”¨

å¦‚æœæœ¬é¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·å¼•ç”¨ï¼š

``bibtex
@misc{pinn_seq3d_2024,
  title={PINN-Seq3D: A Unified Framework for 3D Printing Quality Prediction and Trajectory Optimization},
  author={Your Name},
  year={2024},
  howpublished={\url{https://github.com/yourusername/3d_printer_pinn4ieee}}
}
```

## è®¸å¯è¯

MIT License

## è”ç³»æ–¹å¼

- Email: your.email@example.com
- GitHub Issues: https://github.com/yourusername/3d_printer_pinn4ieee/issues
