# ==================================================
# Moonraker配置 - gcode_shell_command定义
# ==================================================
#
# 注意：这些配置应该添加到 moonraker.conf 文件中
# 而不是 printer.cfg
#
# 配置文件位置（常见位置）：
#   ~/moonraker.conf
#   /etc/moonraker.conf
#   ~/printer_data/config/moonraker.conf

# ==================================================
# 定义shell命令：触发拍照
# ==================================================

[gcode_shell_command TRIGGER_PHOTO]
command: curl -s -X POST http://10.168.1.118:5000/capture -H "Content-Type: application/json" -d '{"layer": {layer}, "filename": "{filename}"}'
timeout: 10.0
verbose: false

[gcode_shell_command SAVE_DATASET]
command: curl -s -X POST http://10.168.1.118:5000/save
timeout: 5.0
verbose: false

[gcode_shell_command CHECK_SERVICE]
command: curl -s http://10.168.1.118:5000/status
timeout: 5.0
verbose: false

# ==================================================
# 说明
# ==================================================
#
# 这些命令定义后，可以在Klipper的printer.cfg中的宏里调用
#
# 参数说明：
#   {layer} - 层高度（微米）
#   {filename} - G-code文件名
#
# 使用示例（在printer.cfg的宏中）：
#   TRIGGER_PHOTO LAYER=10200 FILENAME=test.gcode
#
